#' Colour Values
#'
#' maps colours to values
#'
#' @param x vector of values to map to a colour
#' @param palette colour palette. See details and examples
#' @param na_colour hex string colour to use for NA values in the form \code{#RRGGBBAA}.
#' @param alpha optional. Single value in [0,255] applied to all colours, or
#' a vector of numeric values the same length as \code{x}. The numeric vector
#' will be scaled into the range [0,255].
#' If a matrix palette is supplied with an 'alpha' column, this argument is ignored.
#' @param return either 'hex' or 'rgb'. If 'hex' hex colours are returned.
#' If 'rgb' a length(\code{x}) x 4-column matrix is returned with columns in
#' the order red, green, blue and alpha, and each row corresponds to each element of \code{x}
#'
#' @details
#'
#' The palette can either be
#' \itemize{
#'   \item{String - }{"viridis", "inferno", "plasma", "magma", "cividis"}
#'   \item{Matrix - }{At least 5 rows, and 3 (or 4) columns representing the red, green and blue (and alpha) values}
#' }
#'
#' @examples
#'
#' ## in-built palettes
#' colour_values(x = 1:5) ## default is "viridis"
#' colour_values(x = 1:5, palette = "inferno")
#' colour_values(x = 1:5, palette = "plasma")
#' colour_values(x = 1:5, palette = "magma")
#' colour_values(x = 1:5, palette = "cividis")
#'
#' ## matrix palette
#' n <- 100
#' m <- grDevices::colorRamp(c("red", "green"))( (1:n)/n )
#' df <- data.frame(a = 10, x = 1:n)
#' df$col <- colour_values(df$x, palette = m)
#' barplot(height = df$a, col = df$col, border = NA, space = 0)
#'
#' ## with an alpha column on the palette
#' n <- 100
#' m <- grDevices::colorRamp(c("red", "green"))( (1:n)/n )
#' m <- cbind(m, seq(0, 255, length.out = 100))
#' df <- data.frame(a = 10, x = 1:n)
#' df$col <- colour_values(df$x, palette = m)
#' barplot(height = df$a, col = df$col, border = NA, space = 0)
#'
#' ## single alpha value for all colours
#' df <- data.frame(a = 10, x = 1:255)
#' df$col <- colour_values(df$x, alpha = 50)
#' barplot(height = df$a, col = df$col, border = NA, space = 0)
#'
#' ## vector of alpha values
#' df <- data.frame(a = 10, x = 1:300, y = rep(c(1:50, 50:1), 3) )
#' df$col <- colour_values(df$x, alpha = df$y)
#' barplot(height = df$a, col = df$col, border = NA, space = 0)
#'
#' @export
colour_values <- function( x, palette = "viridis", na_colour = "#808080FF", alpha = 255,
                           return = c("hex","rgb") ) {
  return <- match.arg(return)
  if (return == "hex" ) {
    colour_values_hex( x, palette, na_colour, alpha )
  } else {
    colour_values_rgb( x, palette, na_colour, alpha )
  }
}

#' color values
#' maps colours to values
#' @describeIn
#' @inheritParams colour_values
#' @seealso colour_values
#' @export
color_values <- colour_values

### HEX ------------------------------------------------------------------------

colour_num_values_with_palette_hex <- function( palette, x, na_colour, alpha ) {
  UseMethod("colour_num_values_with_palette_hex")
}

#' @export
colour_num_values_with_palette_hex.character <- function( palette, x, na_colour, alpha ) {
  palette <- match.arg(palette, choices  = c("viridis","inferno","plasma","magma","cividis"))
  rcpp_colour_num_value_string_palette_hex( x, palette, na_colour, alpha )
}

#' @export
colour_num_values_with_palette_hex.matrix <- function( palette, x, na_colour, alpha ) {
  rcpp_colour_num_value_rgb_palette_hex( x, palette, na_colour )
}

#' @export
colour_num_values_with_palette_hex.function <- function( palette, x, na_colour, alpha ) {
  print ("functional palette")
}

colour_str_values_with_palette_hex <- function( palette, x, na_colour, alpha ) {
  UseMethod("colour_str_values_with_palette_hex")
}

#' @export
colour_str_values_with_palette_hex.character <- function( palette, x, na_colour, alpha ) {
  palette <- match.arg(palette, choices  = c("viridis","inferno","plasma","magma","cividis"))
  rcpp_colour_str_value_string_palette_hex(x, palette, na_colour, alpha )
}

#' @export
colour_str_values_with_palette_hex.matrix <- function( palette, x, na_colour, alpha ) {
  rcpp_colour_str_value_rgb_palette_hex( x, palette, na_colour )
}

#' @export
colour_str_values_with_palette_hex.function <- function( palette, x, na_colour, alpha ) {
  print ("functional palette")
}

colour_values_hex <- function( x, palette = "viridis", na_colour, alpha ) {
  UseMethod("colour_values_hex")
}

#' @export
colour_values_hex.character <- function( x, palette = "viridis", na_colour, alpha ) {
  colour_str_values_with_palette_hex( palette, x, na_colour, alpha )
}

#' @export
colour_values_hex.default <- function( x, palette = "viridis", na_colour, alpha ) {
  colour_num_values_with_palette_hex( palette, x, na_colour, alpha )
}

### end HEX ---------------------------------------------------------------------

### RGB ------------------------------------------------------------------------

colour_num_values_with_palette_rgb <- function( palette, x, na_colour, alpha ) {
  UseMethod("colour_num_values_with_palette_rgb")
}

#' @export
colour_num_values_with_palette_rgb.character <- function( palette, x, na_colour, alpha ) {
  palette <- match.arg(palette, choices  = c("viridis","inferno","plasma","magma","cividis"))
  rcpp_colour_num_value_string_palette_rgb( x, palette, na_colour, alpha )
}

#' @export
colour_num_values_with_palette_rgb.matrix <- function( palette, x, na_colour, alpha ) {
  rcpp_colour_num_value_rgb_palette_rgb( x, palette, na_colour )
}

#' @export
colour_num_values_with_palette_rgb.function <- function( palette, x, na_colour, alpha ) {
  print ("functional palette")
}

colour_str_values_with_palette_rgb <- function( palette, x, na_colour, alpha ) {
  UseMethod("colour_str_values_with_palette_rgb")
}

#' @export
colour_str_values_with_palette_rgb.character <- function( palette, x, na_colour, alpha ) {
  palette <- match.arg(palette, choices  = c("viridis","inferno","plasma","magma","cividis"))
  rcpp_colour_str_value_string_palette_rgb(x, palette, na_colour, alpha )
}

#' @export
colour_str_values_with_palette_rgb.matrix <- function( palette, x, na_colour, alpha ) {
  rcpp_colour_str_value_rgb_palette_rgb( x, palette, na_colour )
}

#' @export
colour_str_values_with_palette_rgb.function <- function( palette, x, na_colour, alpha ) {
  print ("functional palette")
}

colour_values_rgb <- function( x, palette = "viridis", na_colour, alpha ) {
  UseMethod("colour_values_rgb")
}

#' @export
colour_values_rgb.character <- function( x, palette = "viridis", na_colour, alpha ) {
  colour_str_values_with_palette_rgb( palette, x, na_colour, alpha )
}

#' @export
colour_values_rgb.default <- function( x, palette = "viridis", na_colour, alpha ) {
  colour_num_values_with_palette_rgb( palette, x, na_colour, alpha )
}
